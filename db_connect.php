<?php
// --- ЁЯЪА Aiven & Render DB Connection File ---

// 1. р╕нр╣Ир╕▓р╕Щр╕Др╣Ир╕▓р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Ир╕▓р╕Б Environment Variables р╕Вр╕нр╕З Render
// (р╕Щр╕╡р╣Ир╕Др╕╖р╕нр╕Др╣Ир╕▓ 5 р╕Хр╕▒р╕зр╕Чр╕╡р╣Ир╣Ар╕гр╕▓р╕Хр╕▒р╣Йр╕Зр╣Гр╕Щ Dashboard р╕Вр╕нр╕З Render)
$host = getenv('DB_HOST');
$port = getenv('DB_PORT');
$user = getenv('DB_USER');
$pass = getenv('DB_PASS');
$db   = getenv('DB_NAME');

// 2. р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н
$conn = mysqli_init();
if (!$conn) {
    die("тЭМ Error: mysqli_init failed");
}

// 3. тЬЕ [р╕кр╕│р╕Др╕▒р╕Нр╕бр╕▓р╕Б] р╕кр╕▒р╣Ир╕Зр╣Гр╕лр╣Й MySQLi р╣Гр╕Кр╣Й SSL (Aiven р╕Ър╕▒р╕Зр╕Др╕▒р╕Ъ)
mysqli_ssl_set($conn, NULL, NULL, NULL, NULL, NULL);

// 4. р╕Юр╕вр╕▓р╕вр╕▓р╕бр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Ир╕гр╕┤р╕З (р╣Вр╕Фр╕вр╣Гр╕Кр╣Й SSL)
$isConnected = mysqli_real_connect(
    $conn,
    $host,
    $user,
    $pass,
    $db,
    (int)$port, // р╣Бр╕Ыр╕ер╕З Port р╣Ар╕Ыр╣Зр╕Щр╕Хр╕▒р╕зр╣Ар╕ер╕В
    NULL,
    MYSQLI_CLIENT_SSL // р╕Ър╕▒р╕Зр╕Др╕▒р╕Ър╣Гр╕Кр╣Й SSL
);

// 5. р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Ьр╕ер╕ер╕▒р╕Юр╕Шр╣М
if (!$isConnected) {
    // р╕Цр╣Йр╕▓р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕ер╣Йр╕бр╣Ар╕лр╕ер╕з р╣Гр╕лр╣Йр╕лр╕вр╕╕р╕Фр╕Чр╕│р╕Зр╕▓р╕Щр╣Бр╕ер╕░р╣Бр╕кр╕Фр╕З Error
    die("тЭМ Connection Failed: " . mysqli_connect_error());
}

// р╕Цр╣Йр╕▓р╕бр╕▓р╕Цр╕╢р╕Зр╕Хр╕гр╕Зр╕Щр╕╡р╣Йр╣Др╕Фр╣Й р╣Бр╕Ыр╕ер╕зр╣Ир╕▓р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕кр╕│р╣Ар╕гр╣Зр╕И
// р╣Др╕Яр╕ер╣Мр╕нр╕╖р╣Ир╕Щр╣Ж р╣Гр╕Щр╣Вр╕Ыр╕гр╣Ар╕Ир╕Бр╕Хр╣М (р╣Ар╕Кр╣Ир╕Щ index.php) р╕Ир╕░ include р╣Др╕Яр╕ер╣Мр╕Щр╕╡р╣Й
// р╣Бр╕ер╕░р╕Ир╕░р╣Др╕Фр╣Йр╕Хр╕▒р╕зр╣Бр╕Ыр╕г $conn р╣Др╕Ыр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щр╕Хр╣Ир╕н
?>